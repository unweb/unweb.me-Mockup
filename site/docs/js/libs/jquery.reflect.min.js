(function(c){function a(d,e,i,j,g,l){d.drawImage(e,0,0,i,j);var f=d.getImageData(0,j,i,g);for(var h=0;h<g;h++){for(var k=0;k<e.width;k++){f.data[(k+h*e.width)*4+3]=l-((h*1)/g)*l}}d.putImageData(f,0,e.height)}function b(h,f,g){var i=c(this);if(this.tagName.toLowerCase()=="img"){var e=document.createElement("canvas");c(e).attr("title",c(h).attr("title")).attr("alt",c(h).attr("alt"));function d(){var k=c(h);var m=k.attr("width");var j=k.attr("height");e.width=m;e.height=j*(1+g);var l=e.getContext("2d");l.drawImage(h,0,0,m,j);l.save();l.translate(0,2*j);l.save();l.transform(1,0,0,-1,0,0);a(l,this,m,j,e.height-j,f);l.restore();l.restore();c(e).replaceAll(h).append(h);c(this).unbind(d)}if(!this.complete){console.log("binding");c(this).bind("onload",d)}else{d.apply(this)}i=e}return i}c.fn.reflect=function(f){var h=jQuery.extend({startOpacity:0.6,reflectionScale:0.5},f);var e=document.createElement("canvas");if(!e.getContext){return this}for(var g=0;g<this.length;g++){var d=this[g];this[g]=b.apply(d,[d,h.startOpacity*255>255?255:h.startOpacity*255,h.reflectionScale])}return this}})(jQuery);